<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"> 
        <title>ğŸ“¤ì‚°ì•…íšŒ ë“±ë°˜(íŠ¸ë˜í‚¹)ì‹ ì²­ì„œ</title>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function () {
                // í˜„ì¬ ì‹ ì²­ì¸ì› ë¶ˆëŸ¬ì˜¤ê¸°
                $.get(
                    'https://script.google.com/macros/s/AKfycbxHpu_I2T2M8JLxHgRLSqDFzRIogTx-x4OcLf9' +
                            'CxjziJQb5_vBFp9TCStU2JpKca_m4Iw/exec?totalParticipants=true',
                    function (response) {
                        $('#currentParticipants').text(
                            `ğŸ¤·â€â™‚ï¸í˜„ì¬ ì´ ${response.total}ëª…ì´ ì°¸ê°€ ì‹ ì²­ì¤‘ì…ë‹ˆë‹¤ \n(âš ${response.waiting}ëª…ì€ ì ‘ìˆ˜ ëŒ€ê¸°ì¤‘ì…ë‹ˆë‹¤.)`
                        );
                        window.totalParticipants = response.total; // ì „ì—­ ë³€ìˆ˜ë¡œ ì €ì¥
                    },
                    'json'
                );

                // ì œì¶œí•˜ê¸°
                $('#signupForm').on('submit', function (event) {
                    event.preventDefault();

                    var formData = {
                        name: $('#name').val(),
                        tel: $('#tel').val(),
                        join: $('#join').val(),
                        joinbaby: $('#joinbaby').val(),
                        joinoption: $('#joinoption').val(),
                        etc: $('#etc').val()
                    };

                    var confirmationMessage = `ğŸ¤·â€â™€ï¸ì…ë ¥í•˜ì‹  ë‚´ìš©ì„ í™•ì¸í•´ ì£¼ì„¸ìš” \n
        - ì„±  ëª…: ${formData.name}
        - ì—°ë½ì²˜: ${formData.tel}
        - ì°¸ì„ì¸ì›: ${formData.join}
        - ì˜ˆë¹„íšŒì›: ${formData.joinbaby}
        - ì„ íƒ ì½”ìŠ¤: ${formData.joinoption}\n`;

                    if (confirm(confirmationMessage + '\nì´ëŒ€ë¡œ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ
                        var $submitButton = $('#signupButton');
                        $submitButton
                            .prop('disabled', true)
                            .text('ğŸ“¤ì œì¶œì¤‘...');

                        $
                            .post(
                                'https://script.google.com/macros/s/AKfycbxHpu_I2T2M8JLxHgRLSqDFzRIogTx-x4OcLf9' +
                                        'CxjziJQb5_vBFp9TCStU2JpKca_m4Iw/exec',
                                formData,
                                function (response) {
                                    alert(response.message);
                                },
                                'json'
                            )
                            .always(function () {
                                // ì™„ë£Œ í›„ ë²„íŠ¼ ìƒíƒœ ë³µì›
                                $submitButton
                                    .prop('disabled', false)
                                    .text('ğŸ“¤ì œì¶œí•˜ê¸°');
                            });
                    }
                });

                // ì¡°íšŒí•˜ê¸°
                    $('#searchButton').on('click', function () {
                    var $searchButton = $('#searchButton');
                    alert('ğŸ¤·â€â™€ï¸ì¡°íšŒì¤‘ì…ë‹ˆë‹¤. ì ì‹œí›„ ê²°ê³¼ë¥¼ ì•„ë˜ì— í‘œì‹œí•©ë‹ˆë‹¤. \nì ‘ìˆ˜ìƒíƒœëŠ” ì•½ 1ë¶„í›„ì— ë°˜ì˜ ë©ë‹ˆë‹¤.');
                    $searchButton
                        .prop('disabled', true)
                        .text('ğŸ”ì¡°íšŒì¤‘...');
                
                    var tel = $('#telInput').val();
                
                    $('html, body').animate({
                        scrollTop: $('#searchResult').offset().top
                    }, 1000);
                
                    $.get(
                        'https://script.google.com/macros/s/AKfycbxHpu_I2T2M8JLxHgRLSqDFzRIogTx-x4OcLf9CxjziJQb5_vBFp9TCStU2JpKca_m4Iw/exec',
                        {
                            tel: tel
                        },
                        function (response) {
                            if (response.status === 'success') {
                                var data = response.data;
                                var formattedResult = `â–¶ì„±ëª…: ${data.name} /\nì°¸ì„ì¸ì›: ${data.join}ëª… /\nì½”ìŠ¤: ${data.joinoption} /\nì ‘ìˆ˜ìƒíƒœ: ${data.state}`;
                                $('#searchResult').text(formattedResult);
                
                                $('#updateSection').show();
                                $('#currentTel').val(data.tel);
                                $('#currentJoin').val(data.join);
                
                                updateJoinOptions(parseInt(data.join));
                            } else {
                                alert(response.message);
                            }
                        },
                        'json'
                    )
                    .always(function () {
                        $searchButton
                            .prop('disabled', false)
                            .text('ğŸ”ì¡°íšŒí•˜ê¸°');
                    });
                });
                
                // ë³€ê²½í•˜ê¸°
                $('#updateButton').on('click', function () {
                    var $updateButton = $('#updateButton');
                    $updateButton
                        .prop('disabled', true)
                        .text('ğŸ”ë³€ê²½(ì·¨ì†Œ) ì²˜ë¦¬ì¤‘...');

                    var tel = $('#currentTel').val();
                    var newJoin = $('#newJoin').val();
                    var currentJoin = $('#currentJoin').val();

                    if (parseInt(newJoin) === parseInt(currentJoin)) {
                        alert('í˜„ì¬ ì‹ ì²­ëœ ì¸ì›ê³¼ ê°™ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ê°’ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.');
                        $updateButton
                            .prop('disabled', false)
                            .text('ğŸ”ë³€ê²½í•˜ê¸°');
                        return;
                    }

                    // ì·¨ì†Œ ì—¬ë¶€ í™•ì¸
                    if (parseInt(newJoin) === 0) {
                        if (!confirm('ğŸ¤·ì°¸ì„ì„ ì·¨ì†Œ í•˜ëŠ”ê²ƒì´ ë§ë‚˜ìš”?\n')) {
                            $updateButton
                                .prop('disabled', false)
                                .text('ğŸ”ë³€ê²½í•˜ê¸°');
                            return;
                        }
                    }

                    var confirmationMessage = `ğŸ¤·â€â™€ï¸ë³€ê²½ì‹ ì²­ë‚´ìš©í™•ì¸:\n
  - í˜„ì¬ ì‹ ì²­ ì¸ì›: ${currentJoin}ëª…
  - ë³€ê²½ í›„ ì¸ì›: ${newJoin}ëª…\n`;

                    if (confirm(confirmationMessage + '\nì´ëŒ€ë¡œ ë³€ê²½(ì·¨ì†Œ) í• ê¹Œìš”?\n ì ‘ìˆ˜ìƒíƒœëŠ” ì•½ 1ë¶„í›„ì— ë°˜ì˜ë©ë‹ˆë‹¤. \n')) {
                        $
                            .post(
                                'https://script.google.com/macros/s/AKfycbxHpu_I2T2M8JLxHgRLSqDFzRIogTx-x4OcLf9' +
                                        'CxjziJQb5_vBFp9TCStU2JpKca_m4Iw/exec',
                                {
                                    tel: tel,
                                    join: newJoin
                                },
                                function (response) {
                                    alert(response.message);
                                },
                                'json'
                            )
                            .always(function () {
                                // ì™„ë£Œ í›„ ë²„íŠ¼ ìƒíƒœ ë³µì›
                                $updateButton
                                    .prop('disabled', false)
                                    .text('ğŸ”ë³€ê²½í•˜ê¸°');
                            });
                    } else {
                        // ì‚¬ìš©ìê°€ ì·¨ì†Œë¥¼ ì„ íƒí•œ ê²½ìš°
                        $updateButton
                            .prop('disabled', false)
                            .text('ğŸ”ë³€ê²½í•˜ê¸°');
                    }
                });

                function updateJoinOptions(currentJoin) {
                    var totalParticipants = window.totalParticipants;
                    var joinSelect = $('#newJoin');
                    joinSelect.empty();

                    for (var i = 0; i <= 5; i++) {
                        if (totalParticipants > 40 && i >= currentJoin) {
                            /* alert('âš ì‹ ì²­ì¸ì›ì´ 40ëª…ì„ ì´ˆê³¼í•˜ëŠ” ê²½ìš° í˜„ì¬ë³´ë‹¤ ì ê²Œë§Œ ë³€ê²½í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤'); */
                            continue; // 40ëª…ì„ ì´ˆê³¼í•œ ê²½ìš° í˜„ì¬ ì‹ ì²­ì¸ì›ë³´ë‹¤ í° ê°’ì€ ì¶”ê°€í•˜ì§€ ì•ŠìŒ
                        }
                        joinSelect.append(new Option(i + (
                            i === 0
                                ? '(ì·¨ì†Œ)'
                                : 'ëª…'
                        ), i));
                    }
                }
            });
        </script>
        <style>
            body {
                margin: 20px;
            }
            #searchResult {
                font-weight: 600;
                font-size: large;
                color: coral;
            }
            #currentParticipants {
                font-weight: 600;
                font-size: large;
                color: crimson;
            }
            .input-group-text {
                width: 130px;
                text-align: center;
            }
            img {
                width: 100%;
                border-radius: 10px;
            }
            #shownotice {
                display: none;
            }
            .slideshow-container {
                position: relative;
                width: 100%;
                height: 350px;
                /* ì´ ê°’ì€ ì´ë¯¸ì§€ í¬ê¸°ì— ë§ê²Œ ì¡°ì •í•˜ì„¸ìš” */
                max-width: 600px;
                margin: auto;
                overflow: hidden;
                opacity: 1;
                transition: opacity 2s ease-in-out;
            }
            .slideshow-image {
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0;
                left: 0;
                opacity: 0;
                transition: opacity 2s ease-in-out;
            }
            .visible {
                opacity: 1;
            }
            .watermark {
                position: absolute;
                bottom: 10px;
                right: 10px;
                color: rgba(255, 255, 255, 0.7);
                font-size: 21px;
                font-weight: bold;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
                z-index: 10;
            }
            @media (max-width: 600px) {
                .watermark {
                    font-size: 18px;
                }
            }
        </style>
    </head>
    <body>
        <div class="slideshow-container">
            <div class="slide">
                <img src="img/dota01.jpg" class="slideshow-image">
                <div class="watermark">ğŸï¸ë‘íƒ€ì‚°+ì¶”ì•”ì´›ëŒ€ë°”ìœ„(2024.9.7í† )</div>
            </div>
            <div class="slide">
                <img src="img/dota02.jpg" class="slideshow-image">
            </div>
            <div class="slide">
                <img src="img/dota03.jpg" class="slideshow-image">
                <!-- <div class="watermark">ğŸï¸ë‘íƒ€ì‚°(ì‚°í–‰ì¼ì •:2024.7.6í† )</div> -->
            </div>
            <div class="slide">
                <img src="img/dota04.jpg" class="slideshow-image">
            </div>
            <div class="slide">
                <img src="img/dota05.jpg" class="slideshow-image">
                <!-- <div class="watermark">ğŸï¸ë‘íƒ€ì‚°(ì‚°í–‰ì¼ì •:2024.7.6í† )</div> -->
            </div>
            <div class="slide">
                <img src="img/lock01.jpg" class="slideshow-image">
            </div>
            <div class="slide">
                <img src="img/lock02.jpg" class="slideshow-image">
            </div>
        </div>
        <h4>
            <b>ğŸ“¢9ì›” ë™í•´ ë‘íƒ€ì‚°(ì¶”ì•”ì´›ëŒ€ë°”ìœ„)ì‚°í–‰ ì¼ì •</b>
        </h4><br>
        <p>
            9ì›”ì—ëŠ” 7ì›”ì— ìš°ì²œìœ¼ë¡œ ì·¨ì†Œëœ ë¬´ë¦‰ê³„ê³¡ì„ í’ˆì€ ë™í•´ ë‘íƒ€ì‚°ìœ¼ë¡œ ë‹¤ì‹œ ë„ì „ í•©ë‹ˆë‹¤.
            <br>
            ì¶”ê°€ë¡œ, ì¶”ì•”ì´›ëŒ€ë°”ìœ„ë„ ê²½ìœ í•˜ì—¬ ì‚°ê³¼ ë°”ë‹¤ë¥¼ í•¨ê»˜ ì¦ê¸°ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            <br><br>
            ğŸ“…ì¼ì‹œ: 2024.9.7(í† ) 6ì‹œ ~ 19ì‹œ<br>
            ğŸ• ì¥ì†Œ : ë™í•´ ë‘íƒ€ì‚° + ì¶”ì•”ì´›ëŒ€ë°”ìœ„(ì¶œë ë‹¤ë¦¬)<br>
            Aì½”ìŠ¤: ë°°í‹€ë°”ìœ„+ë‘íƒ€ì‚°ì„±(ì‚°í–‰ 5ì‹œê°„/ë‚œì´ë„:ì¤‘ìƒ)<br>
            Bì½”ìŠ¤: ë¬´ë¦‰ê³„ê³¡ ì½”ìŠ¤(íŠ¸ë˜í‚¹ 4ì‹œê°„ ë‚œì´ë„:í•˜)<br>
            â­ê²½ìœ : ì¶”ì•”ì´›ëŒ€ë°”ìœ„(ì¶œë ë‹¤ë¦¬)<br><br>
            ğŸ’³ ì°¸ê°€ë¹„[ì•„ì¹¨ê°„ë‹¨ì‹ + í•˜ì‚°ì‹ í¬í•¨]<br>
            Aì½”ìŠ¤|Bì½”ìŠ¤: 2.5ë§Œì›(ë¹„íšŒì› 4ë§Œì›)<br><br>
            ğŸ“…ì‹ ì²­ê¸°ê°„: ~ 8.4ì¼(ì¼)ê¹Œì§€ (ë™ì•„ë¦¬ íšŒì› ìš°ì„  ì‹ ì²­)<br>
            âš  40ëª… ì„ ì°©ìˆœ ëª¨ì§‘ í›„ ì”ì—¬ì¢Œì„ì— í•œí•´ ë¹„íšŒì› ëª¨ì§‘<br>
        </p>
    </div>
    <div class="container">
        <h5 class="mb-4">ì‚°ì•…íšŒ ë“±ì‚°(íŠ¸ë˜í‚¹) ì‹ ì²­í•˜ê¸°</h5>
        <form id="signupForm" class="mb-5">
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="name-label">ì´ë¦„</span>
                </div>
                <input
                    type="text"
                    class="form-control"
                    id="name"
                    name="name"
                    required="required"
                    aria-describedby="name-label">
            </div>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="tel-label">ì—°ë½ì²˜</span>
                </div>
                <input
                    type="number"
                    class="form-control"
                    id="tel"
                    name="tel"
                    placeholder="ìˆ«ìë§Œ ì…ë ¥"
                    required="required"
                    aria-describedby="tel-label">
            </div>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="join-label">ì°¸ì„ì¸ì›</span>
                </div>
                <select
                    id="join"
                    name="join"
                    class="form-select"
                    required="required"
                    aria-describedby="join-label">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="1">1ëª…</option>
                    <option value="2">2ëª…</option>
                    <option value="3">3ëª…</option>
                    <option value="4">4ëª…</option>
                    <option value="5">5ëª…</option>
                </select>
            </div>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="joinbaby-label">ì˜ˆë¹„íšŒì› ì¸ì›</span>
                </div>
                <select
                    id="joinbaby"
                    name="joinbaby"
                    class="form-select"
                    required="required"
                    aria-describedby="joinbaby-label">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="0">ì—†ìŒ</option>
                    <option value="1">1ëª…</option>
                    <option value="2">2ëª…</option>
                    <option value="3">3ëª…</option>
                    <option value="4">4ëª…</option>
                    <option value="5">5ëª…</option>
                </select>
            </div>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="joinoption-label">ì½”ìŠ¤ëŠ”?</span>
                </div>
                <select
                    id="joinoption"
                    name="joinoption"
                    class="form-select"
                    required="required"
                    aria-describedby="joinoption-label">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="Aì½”ìŠ¤(ì‚°í–‰/ë°°í‹€ë°”ìœ„ì½”ìŠ¤)">Aì½”ìŠ¤(ì‚°í–‰/ë°°í‹€ë°”ìœ„ì½”ìŠ¤)</option>
                    <option value="Bì½”ìŠ¤(íŠ¸ë˜í‚¹/ë¬´ë¦‰ê³„ì†ì½”ìŠ¤)">Bì½”ìŠ¤(íŠ¸ë˜í‚¹/ë¬´ë¦‰ê³„ê³¡ì½”ìŠ¤)</option>
                </select>
            </div>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="etc-label">ğŸ’¬ê¸°íƒ€ ì½”ë©˜íŠ¸</span>
                </div>
                <input
                    type="text"
                    class="form-control"
                    id="etc"
                    name="etc"
                    aria-describedby="etc-label">
            </div>
            <button type="submit" id="signupButton" class="btn btn-primary btn-block">ğŸ“¤ì œì¶œí•˜ê¸°</button>
        </form>
        <div id="currentParticipants" class="mb-4"></div>
        <hr>
        <h4 class="mb-4">ğŸ”ì‹ ì²­ë‚´ì—­ ì¡°íšŒ ë° ë³€ê²½(ì·¨ì†Œ)í•˜ê¸°</h4>
        <div class="mb-3">
            <label for="telInput" class="form-label">ğŸ¤·â€â™‚ï¸ì—°ë½ì²˜ ì…ë ¥ í›„ ì¡°íšŒí•˜ì„¸ìš”</label>
            <input
                type="number"
                class="form-control"
                id="telInput"
                placeholder="ìˆ«ìë§Œ ì…ë ¥"
                name="telInput">
        </div>
        <button
            id="searchButton"
            class="btn btn-dark mb-3"
            style="color: whitesmoke; font-weight: 600;">ğŸ”ì¡°íšŒí•˜ê¸°</button>
        <h5 id="searchResult"></h5>
        <br>
        <div id="updateSection" style="display:none;">
            <h4 class="mb-4">ğŸ”ì°¸ì„ì¸ì› ë³€ê²½(ì·¨ì†Œ)í•˜ê¸°</h4>
            <input type="hidden" id="currentTel">
            <input type="hidden" id="currentJoin">
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="newJoin-label">ë³€ê²½í•  ì°¸ì„ì¸ì›:</span>
                </div>
                <select id="newJoin" class="form-select" aria-describedby="newJoin-label">
                    <!-- ì˜µì…˜ì€ JavaScriptë¡œ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. -->
                </select>
            </div>
            <button id="updateButton" class="btn btn-danger">ğŸ”ë³€ê²½í•˜ê¸°</button>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const images = document.querySelectorAll(".slideshow-image");
            let currentImageIndex = 0;
            images[currentImageIndex]
                .classList
                .add("visible"); // ì´ˆê¸° ì´ë¯¸ì§€ë¥¼ ë³´ì´ê²Œ ì„¤ì •

            setInterval(function () {
                // í˜„ì¬ ì´ë¯¸ì§€ì˜ í´ë˜ìŠ¤ë¥¼ ì œê±°í•˜ì—¬ ìˆ¨ê¹ë‹ˆë‹¤.
                images[currentImageIndex]
                    .classList
                    .remove("visible");

                // í˜„ì¬ ì´ë¯¸ì§€ ì¸ë±ìŠ¤ì™€ ë‹¤ë¥¸ ëœë¤ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
                let nextImageIndex;
                do {
                    nextImageIndex = Math.floor(Math.random() * images.length);
                } while (nextImageIndex === currentImageIndex);

                // ë‹¤ìŒ ì´ë¯¸ì§€ ì¸ë±ìŠ¤ë¥¼ í˜„ì¬ ì´ë¯¸ì§€ ì¸ë±ìŠ¤ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
                currentImageIndex = nextImageIndex;

                // ë‹¤ìŒ ì´ë¯¸ì§€ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ ë³´ì´ê²Œ í•©ë‹ˆë‹¤.
                images[currentImageIndex]
                    .classList
                    .add("visible");
            }, 5000); // 5ì´ˆ ê°„ê²©ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì „í™˜í•©ë‹ˆë‹¤.
        });

        let slideIndex = 0;
        showSlides();

        function showSlides() {
            let slides = document.getElementsByClassName("slide");
            for (let i = 0; i < slides.length; i++) {
                slides[i]
                    .getElementsByClassName("slideshow-image")[0]
                    .classList
                    .remove("active");
            }
            slideIndex++;
            if (slideIndex > slides.length) {
                slideIndex = 1;
            }
            slides[slideIndex - 1]
                .getElementsByClassName("slideshow-image")[0]
                .classList
                .add("active");
            setTimeout(showSlides, 3000); // Change image every 5 seconds
        }
    </script>
</body>
</html>